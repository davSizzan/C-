<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width" />
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="./Content/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</head>
<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
    });
</script>

<body>
    <div>
        <div class="wrapper">
            <!-- Sidebar  -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <a href="/Admin/index.html">
                        <h3>Trang chủ</h3>
                    </a>
                </div>

                <ul class="list-unstyled components">
                    <p>Trang mua sắm</p>
                    <li class="active">
                        <a href="#" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Sản phẩm</a>
                        <ul class="collapse list-unstyled" id="homeSubmenu">
                            <li>
                                <a href="#">Đăng sản phẩm</a>
                            </li>
                            <li>
                                <a href="#">Danh sách sản phẩm</a>
                            </li>
                            <li>
                                <a href="#">Danh mục sản phẩm</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Đơn hàng</a>
                        <ul class="collapse list-unstyled" id="donhang">
                            <li>
                                <a href="#">Danh sách đơn hàng</a>
                            </li>
                            <li>
                                <a href="#">Quản lý vận chuyển</a>
                            </li>
                            <li>
                                <a href="#">Hủy/Đổi/Trả/Hoàn tiền</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="./Customers.html">Khách hàng</a>
                    </li>
                    <li>
                        <a href="#thongke" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Thống kê</a>
                        <ul class="collapse list-unstyled" id="thongke">
                            <li>
                                <a href="#">Doanh thu</a>
                            </li>
                            <li>
                                <a href="#">Sản phẩm</a>
                            </li>

                        </ul>
                    </li>
                    <li>
                        <a href="./Information.html">Thông tin tài khoản</a>
                    </li>
                    <li>


                        <a href="./login.html">Thoát</a>
                    </li>

                </ul>
            </nav>

            <!-- Page Content  -->
            <div id="content">


                <div class="container-fluid menu-content">

                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i>
                        <span>Menu</span>
                    </button>

                </div>
                <br />
                <div class="container">
                    <form>
                        <div class="form-group">
                            <label for="id">Mã Sản Phẩm</label>
                            <input type="text" class="form-control" id="id">
                        </div>
                        <div class="form-group">
                            <label for="name">Tên Sản Phẩm</label>
                            <input type="text" class="form-control" id="name">
                        </div>
                        <div class="form-group">
                            <label for="gia">Giá</label>
                            <input type="text" class="form-control" id="gia">
                        </div>
                        <div class="form-group">
                            <label for="sale">Sale</label>
                            <input type="text" class="form-control" id="sale">
                        </div>
                        <div class="form-group">
                            <label for="loai">Loại</label>
                            <input type="text" class="form-control" id="loai">
                        </div>
                        <div class="form-group">
                            <label for="mota">Mô Tả</label>
                            <input type="text" class="form-control" id="mota">
                        </div>
                        <div class="form-group">
                            <label for="anh">Ảnh</label>
                            <input type="text" class="form-control" id="anh">
                        </div>
                        <div class="form-group">
                            <label for="ngaytao">Ngày Tạo</label>
                            <input type="text" class="form-control" id="ngaytao">
                        </div>
                        <div class="form-group">
                            <label for="createID">CreateByID</label>
                            <input type="text" class="form-control" id="createID">
                        </div>
                        <button type="button" class="btn btn-primary" onclick="AddProduct()">Thêm Sản Phẩm</button>
                        <button type="button" class="btn btn-primary" onclick="UpdateProduct()">Sửa Sản Phẩm</button>

                        <button type="button" class="btn btn-primary" onclick="DeleteCustomer()">Xóa khách hàng</button>
                    </form>
                    <table id="KhachHang" class="table table-striped table-bordered">
                        <thead class="thead-light">
                            <tr>
                                <th>Mã SP</th>
                                <th>Tên SP</th>
                                <th>Giá</th>
                                <th>Sale</th>
                                <th>Loại</th>
                                <th>Mô Tả</th>
                                <th>Ảnh</th>
                                <th>Ngày Tạo</th>
                                <th>CreateByID</th>
                                <th>Xóa</th>
                                <th>Sửa</th>
                            </tr>
                        </thead>
                        <tbody id="allKH"></tbody>
                    </table>
                </div>

            </div>

        </div>
</body>
<script type="text/javascript">
    let url = 'https://localhost:44315/';
    $(document).ready(function() {
        GetAllProducts();
    });

    function GetAllProducts() {
        $.ajax({
            url: url + 'api/product',
            method: 'GET',
            contentType: 'json',
            dataType: 'json',
            error: function(res) {

            },
            success: function(res) {
                const len = res.length;
                console.log(res);
                let table = '';
                for (var i = 0; i < len; ++i) {
                    table = table + '<tr>';
                    table = table + '<td>' + res[i].id + '</td>';
                    table = table + '<td>' + res[i].TenSanPham + '</td>';
                    table = table + '<td>' + res[i].Gia + '</td>';
                    table = table + '<td>' + res[i].Sale + '</td>';
                    table = table + '<td>' + res[i].Loai + '</td>';
                    table = table + '<td>' + res[i].MoTa + '</td>';
                    table = table + '<td>' + res[i].Anh + '</td>';
                    table = table + '<td>' + res[i].NgayTao + '</td>';
                    table = table + '<td>' + res[i].createbyID + '</td>';
                    table = table + '<td><button type="button" class="btn btn-danger" onclick = "DeleteCustomer(\'' + res[i].id + '\');"> Xóa </button></td>';
                    table = table + '<td><button type="button" class="btn btn-warning" onclick = "GetProduct(\'' + res[i].id + '\');"> Sửa </button></td>';
                    table = table + '</tr>';
                }
                document.getElementById('allKH').innerHTML = table;
            },
            fail: function(response) {}

        })
    }

    function AddProduct() {
        $.ajax({
            url: url + 'api/product' + "?id=" + $("#id").val() + "&name=" + $("#name").val() + "&gia=" + $("#gia").val() + "&sale=" + $("#sale").val() +
                "&loai=" + $("#loai").val() + "&mota=" + $("#mota").val() + "&anh=" + $("#anh").val() + "&ngaytao=" + $("#ngaytao").val() +
                "&createID=" + $("#createID").val(),
            method: "POST",
            contentType: 'json',
            dataType: 'json',
            error: function(res) {
                alert("Them moi khong thanh cong");
            },
            success: function(res) {
                alert("Them moi thanh cong");
                console.log()
                GetAllProducts(url + 'api/product' + "?id=" + $("#id").val() + "&name=" + $("#name").val() + "&gia=" + $("#gia").val() + "&sale=" + $("#sale").val() +
                    "&loai=" + $("#loai").val() + "&mota=" + $("#mota").val() + "&anh=" + $("#anh").val() + "&ngaytao=" + $("#ngaytao").val() +
                    "&createID=" + $("#createID").val());
            },
            fail: function(response) {}
        })
    }

    function GetProduct(id) {
        $.ajax({
            url: url + "api/product/" + id,
            method: 'GET',
            contentType: 'json',
            dataType: 'json',
            error: function(res) {

            },
            success: function(res) {
                console.log(res);
                $("#id").val(res.id),
                    $("#name").val(res.TenSanPham),
                    $("#gia").val(res.Gia),
                    $("#sale").val(res.Sale),
                    $("#loai").val(res.Loai),
                    $("#mota").val(res.MoTa),
                    $("#anh").val(res.Anh),
                    $("#ngaytao").val(res.NgayTao),
                    $("#createID").val(res.createbyID)
            },
            fail: function(response) {}

        })
    }

    function UpdateProduct() {
        $.ajax({
            url: url + 'api/product' + "?id=" + $("#id").val() +
                "&name=" + $("#name").val() + "&gia=" + $("#gia").val() + "&sale=" + $("#sale").val() +
                "&loai=" + $("#loai").val() + "&mota=" + $("#mota").val() + "&anh=" + $("#anh").val() +
                "&ngaytao=" + $("#ngaytao").val() +
                "&createID=" + $("#createID").val(),
            method: "PUT",
            contentType: 'json',
            dataType: 'json',
            error: function(res) {
                alert("Sua khong thanh cong");
            },
            success: function(res) {
                alert("Sua thanh cong");
                GetAllProducts();
            },
            fail: function(response) {}
        })
    }

    function DeleteCustomer(id) {
        $.ajax({
            url: url + "api/product/" + id,
            method: "DELETE",
            contentType: 'json',
            dataType: 'json',
            error: function(res) {
                alert("Xoa khong thanh cong");
            },
            success: function(res) {
                alert("Xoa thanh cong");
                GetAllProducts();
            },
            fail: function(response) {}
        })
    }
</script>

</html>